# name: test/sql/inet/test_ipv6_inet_type.test
# description: Test IPv6 inet type
# group: [inet]

require inet

statement ok
PRAGMA enable_verification

query I
SELECT '2001:db8:100:0:c59b:cef3:a0d1:6de4'::INET;
----
2001:db8:100:0:c59b:cef3:a0d1:6de4

# Allow upper case hex values
query I
SELECT '2001:DB8:100:0:C59B:CEF3:A0D1:6DE4'::INET;
----
2001:db8:100:0:c59b:cef3:a0d1:6de4

# Allow a single zero quibble to use double colon notation
# even though it isn't the proper canonical form.
query I
SELECT '2001:DB8:100::C59B:CEF3:A0D1:6DE4'::INET;
----
2001:db8:100:0:c59b:cef3:a0d1:6de4

query I
SELECT '2001:db8:100:0:c59b:cef3::/96'::INET;
----
2001:db8:100:0:c59b:cef3::/96

query II
SELECT '2001:db8::cef3:35:363/96'::INET, '2001:db8:0:0:0:cef3:35:363/96'::INET;
----
2001:db8::cef3:35:363/96
2001:db8::cef3:35:363/96

query II
SELECT '::1/128'::INET, '0:0:0:0:0:0:0:1/128'::INET;;
----
::1
::1

query II
SELECT '::1'::INET, '0:0:0:0:0:0:0:1'::INET;
----
::1
::1

query II
SELECT '::'::INET, '0:0:0:0:0:0:0:0'::INET;
----
::
::

query II
SELECT '2001:db8::'::INET, '2001:db8:0:0:0:0:0:0'::INET;
----
2001:db8::
2001:db8::

query II
SELECT '::1234:5678'::INET, '0:0:0:0:0:0:1234:5678'::INET;
----
::1234:5678
::1234:5678

query II
SELECT '2001:db8:1::ab9:C0A8:102'::INET, '2001:db8:1:0:0:ab9:C0A8:102'::INET;
----
2001:db8:1::ab9:c0a8:102
2001:db8:1::ab9:c0a8:102

# quibble with too many digits
statement error
SELECT '2001:db8:100:0:c59b:cef3:a0d189:6de4'::INET;
----

# Too many quibbles
statement error
SELECT '2001:db8:100:0:c59b:cef3:a0d1:6de4:d16d'::INET;
----

# Not enough quibbles
statement error
SELECT '2001:db8:100:0:c59b:cef3:a0d1'::INET;
----

# Not enough quibbles
statement error
SELECT ':2:'::INET;
----

# Too many double colons
statement error
SELECT '2001:db8::cef3::363/96'::INET;
----

# Triple colons are not valid
statement error
 SELECT ':::1234:5678'::INET
----

# Invalid subnet mask
statement error
SELECT '2001:db8:100:0:c59b:cef3::/266'::INET;
----

# Invalid characters
statement error
SELECT '2001:db8:100:0z:c59b:cef3::/120'::INET;
----